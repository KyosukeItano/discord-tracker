<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gateway Tracker</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>🔵 Discord Gateway Tracker</h1>
      <div class="status" id="status">
        <span class="status-indicator" id="statusIndicator"></span>
        <span id="statusText">停止中</span>
      </div>
    </header>

    <div class="controls">
      <button id="reloadBtn" class="btn btn-reload">🔄 リロード</button>
      <button id="settingsBtn" class="btn btn-settings">⚙️ 設定</button>
      <button id="exportBtn" class="btn btn-export">📥 エクスポート</button>
      <label class="checkbox-label">
        <input type="checkbox" id="webhookEnabled" checked>
        <span>WebhookでDiscordに通知</span>
      </label>
    </div>

    <!-- タブナビゲーション -->
    <div class="tab-navigation">
      <button class="tab-btn active" data-tab="logs">入退出ログ</button>
      <button class="tab-btn" data-tab="stats">📊 統計</button>
      <button class="tab-btn" data-tab="charts">📈 グラフ</button>
      <button class="tab-btn" data-tab="filter">🔍 フィルタ・検索</button>
      <button class="tab-btn" data-tab="system">システムログ</button>
    </div>

    <!-- タブコンテンツ -->
    <div class="tab-content-container">
      <!-- 入退出ログタブ -->
      <div class="tab-content active" id="tab-logs">
        <div class="log-container">
          <div class="log-header">
            <h2>入退出ログ</h2>
            <button id="clearLogBtn" class="btn-small">クリア</button>
          </div>
          <div class="log-content" id="logContent">
          </div>
        </div>
      </div>

      <!-- 統計タブ -->
      <div class="tab-content" id="tab-stats">
        <div class="stats-container">
          <div class="stats-header">
            <h2>📊 統計</h2>
            <div class="period-selector">
              <button class="period-btn active" data-period="today">今日</button>
              <button class="period-btn" data-period="week">今週</button>
              <button class="period-btn" data-period="month">今月</button>
              <button class="period-btn" data-period="all">全期間</button>
            </div>
          </div>
          <div class="stats-content" id="statsContent">
            <div class="stats-loading">統計データを読み込んでいます...</div>
          </div>
        </div>
      </div>

      <!-- グラフタブ -->
      <div class="tab-content" id="tab-charts">
        <div class="charts-container">
          <div class="charts-header">
            <h2>📈 グラフ</h2>
            <div class="chart-type-selector">
              <button class="chart-type-btn active" data-type="channel">チャンネル別</button>
              <button class="chart-type-btn" data-type="user">ユーザー別</button>
              <button class="chart-type-btn" data-type="hour">時間帯別</button>
            </div>
          </div>
          <div class="chart-wrapper">
            <canvas id="statsChart"></canvas>
          </div>
        </div>
      </div>

      <!-- フィルタ・検索タブ -->
      <div class="tab-content" id="tab-filter">
        <div class="filter-container">
          <div class="filter-header">
            <h2>🔍 フィルタ・検索</h2>
            <button id="clearFilterBtn" class="btn-small">フィルタをクリア</button>
          </div>
          <div class="filter-controls">
            <input type="text" id="searchUserInput" placeholder="ユーザー名で検索..." class="filter-input">
            <input type="text" id="searchChannelInput" placeholder="チャンネル名で検索..." class="filter-input">
            <input type="text" id="searchGuildInput" placeholder="サーバー名で検索..." class="filter-input">
          </div>
        </div>
      </div>

      <!-- システムログタブ -->
      <div class="tab-content" id="tab-system">
        <div class="system-log-container">
          <div class="log-header">
            <h2>システムログ</h2>
          </div>
          <div class="log-content" id="systemLogContentInner">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 設定モーダル -->
  <div id="settingsModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>⚙️ 設定</h2>
        <button class="modal-close" id="closeSettingsBtn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <h3>監視チャンネル</h3>
          <div class="channel-list" id="channelList">
            <!-- チャンネルリストがここに動的に追加される -->
          </div>
          <div class="add-channel-form">
            <input type="text" id="newChannelIdInput" placeholder="チャンネルIDを入力..." class="filter-input">
            <button id="addChannelBtn" class="btn-small">追加</button>
          </div>
        </div>
        <div class="settings-section">
          <h3>Webhook設定</h3>
          <label>
            <input type="text" id="webhookUrlInput" placeholder="Webhook URL" class="filter-input" style="width: 100%;">
          </label>
        </div>
        <div class="settings-section">
          <h3>Discord Token</h3>
          <label>
            <input type="password" id="tokenInput" placeholder="Discord User Token" class="filter-input" style="width: 100%;">
            <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">※ トークンは安全に管理してください</small>
          </label>
        </div>
        <div class="settings-section">
          <h3>その他の設定</h3>
          <label>
            <input type="text" id="selfUserIdInput" placeholder="自分のユーザーID（オプション）" class="filter-input" style="width: 100%;">
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button id="saveSettingsBtn" class="btn btn-start">保存</button>
        <button id="cancelSettingsBtn" class="btn btn-stop">キャンセル</button>
      </div>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
